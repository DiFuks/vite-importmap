<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <style>
        div[id^="single-spa-application"]:not(:empty) {
            height: 100%;
        }
    </style>
</head>
<body>
<meta name="importmap-type" content="importmap-shim" />
<import-map-overrides-full show-when-local-storage="devtools"></import-map-overrides-full>
<script type="importmap-shim" src="http://localhost:4000/importmap.json"></script>
<script>
  window.esmsInitOptions = {
    mapOverrides: true,
  }


  window.addEventListener("import-map-overrides:init", () => {
    const isEnabledOverride = !window.importMapOverrides.isDisabled('app')

    if (isEnabledOverride) {
      const overrideMap = window.importMapOverrides.getOverrideMap()

      const kioskModuleUrl = overrideMap.imports.app

      const { origin } = new URL(kioskModuleUrl)

      const viteClientScript = document.createElement('script')
      viteClientScript.src = `${origin}/@vite/client`
      viteClientScript.type = 'module-shim'
      document.head.append(viteClientScript)

      const reactHmrScript = document.createElement('script')
      reactHmrScript.type = 'module-shim'
      reactHmrScript.innerHTML = `
      import RefreshRuntime from '${origin}/@react-refresh'
      RefreshRuntime.injectIntoGlobalHook(window)
      window.$RefreshReg$ = () => {}
      window.$RefreshSig$ = () => (type) => type
      window.__vite_plugin_react_preamble_installed__ = true
    `
      document.head.append(reactHmrScript)
    }
  });
</script>
<script src="/importmapOverride.bundle.js"></script>

<style>
    div[id^="single-spa-application"]:not(:empty) {
        height: 100%;
    }
</style>

<div id="single-spa-application:app"></div>
<script type="module-shim" defer="defer" src="/appshell.bundle.js"></script>
</body>
</html>
